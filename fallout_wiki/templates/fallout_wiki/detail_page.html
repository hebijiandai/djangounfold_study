{% extends 'fallout_wiki/base.html' %}
{% load static %}

{% block title %}{{ display_name }} | Pip-Boy 3000 Mk IV{% endblock %}

{% block content %}
<div class="card p-2 p-md-4">
    {% if main_image_url %}
        <div class="text-center mb-4">
            <img src="{{ main_image_url }}" class="img-fluid rounded" style="max-height: 400px; border: 2px solid var(--pip-boy-green);" alt="{{ display_name }}"/>
        </div>
    {% endif %}

    <h1 class="text-center mb-4">{{ display_name }}</h1>
    <p class="text-center text-muted">{{ model_name_singular }}</p>

    <hr style="border-color: var(--pip-boy-green);" />

    <!-- Additional Images Section -->
    {% if additional_image_urls %}
    <div class="row mb-4">
        {% for img_url in additional_image_urls %}
            <div class="col-md-4 mb-3">
                <img src="{{ img_url }}" class="img-fluid rounded" style="border: 1px solid var(--pip-boy-green);" alt="Additional Image" />
            </div>
        {% endfor %}
    </div>
    <hr style="border-color: var(--pip-boy-green);" />
    {% endif %}

    <!-- Long Text Sections (Explanation, Lore, etc.) -->
    {% for field in fields %}
        {% if field.is_long_text %}
            <div class="mb-4">
                <h3 class="mb-3">{{ field.name }}</h3>
                <p style="line-height: 1.7; white-space: pre-wrap; font-size: 1.1rem;">{{ field.value }}</p>
            </div>
        {% endif %}
    {% endfor %}

    <hr style="border-color: var(--pip-boy-green);" />
    
    <h3 class="mb-4">数据详情</h3>

    <div class="row">
        {% for field in fields %}
            {% if not field.is_long_text %}
                <div class="col-md-6 mb-3">
                    <div class="d-flex align-items-start">
                        <div class="me-3" style="min-width: 120px;">
                            <strong>{{ field.name }}:</strong>
                        </div>
                        <div class="flex-grow-1">
                            {% if field.is_wiki_link %}
                                <!-- Wiki Link Preview Card -->
                                <a href="{{ field.value }}" target="_blank" class="text-decoration-none d-block p-2" style="border: 1px solid var(--pip-boy-green); border-radius: 5px;">
                                    <p class="mb-0">{{ display_name }} Wiki</p>
                                    <p class="mb-0 small text-truncate">{{ field.value }}</p>
                                </a>
                            {% else %}
                                {{ field.value }}
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    </div>
    
    <hr class="my-4" style="border-color: var(--pip-boy-green);" />

    <div class="text-center">
        <a href="{% url 'fallout_wiki:wiki_index' %}" class="btn" style="border: 1px solid var(--pip-boy-green);">
            &lt;&lt; 返回主列表
        </a>
    </div>
</div>
{% endblock %}
